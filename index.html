<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Générateur de devis Dialarme - Systèmes d'alarme et caméras de surveillance">
    <meta name="author" content="Dialarme">
    <title>Générateur de Devis - Dialarme</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><polygon fill='%23f4e600' points='50,10 90,30 90,70 50,90 10,70 10,30'/><polygon fill='%23000' points='50,20 80,35 80,65 50,80 20,65 20,35'/></svg>">
    
    <!-- PWA Support -->
    <meta name="theme-color" content="#f4e600">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Devis Dialarme">
    
    <!-- Preload important resources -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
    
    <style>
        /* Variables CSS - Thème Blanc et Jaune Dialarme */
        :root {
            --primary-color: #f4e600;
            --primary-dark: #d4c600;
            --primary-light: #f9f06a;
            --secondary-color: #000000;
            --accent-color: #333333;
            --success-color: #22c55e;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --white: #ffffff;
            --gray-50: #fafafa;
            --gray-100: #f5f5f5;
            --gray-200: #e5e5e5;
            --gray-300: #d4d4d4;
            --gray-400: #a3a3a3;
            --gray-500: #737373;
            --gray-600: #525252;
            --gray-700: #404040;
            --gray-800: #262626;
            --gray-900: #171717;
            --border-radius: 8px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 25px -5px rgba(0, 0, 0, 0.15);
            --tva-rate: 8.1;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--white);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
            color: var(--secondary-color);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 15px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            border: 3px solid var(--primary-color);
        }

        .header {
            background: var(--white);
            color: var(--secondary-color);
            padding: 30px;
            text-align: center;
            position: relative;
            border-bottom: 3px solid var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .logo {
            max-height: 80px;
            width: auto;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.1));
        }

        .header-text {
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            color: var(--secondary-color);
        }

        .header p {
            font-size: 1.1rem;
            color: var(--gray-600);
        }

        .nav-tabs {
            display: flex;
            background: var(--white);
            border-bottom: 3px solid var(--primary-color);
        }

        .nav-tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            background: var(--white);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 700;
            color: var(--secondary-color);
            position: relative;
            border-right: 1px solid var(--gray-200);
        }

        .nav-tab:last-child {
            border-right: none;
        }

        .nav-tab:hover {
            background: var(--gray-50);
            color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: var(--primary-color);
            border-bottom-color: var(--primary-color);
            color: var(--secondary-color);
            box-shadow: 0 4px 8px rgba(244, 230, 0, 0.3);
        }

        .tab-content {
            display: none;
            padding: 30px;
            background: var(--white);
        }

        .tab-content.active {
            display: block;
        }

        .catalog-toggle, .history-toggle {
            position: fixed;
            background: var(--primary-color);
            color: var(--secondary-color);
            border: 2px solid var(--secondary-color);
            border-radius: 50px;
            padding: 15px 25px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .catalog-toggle {
            bottom: 20px;
            right: 20px;
        }

        .history-toggle {
            bottom: 80px;
            right: 20px;
        }

        .catalog-toggle:hover, .history-toggle:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            background: var(--primary-dark);
        }

        .catalog-modal, .history-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            z-index: 2000;
            overflow-y: auto;
        }

        .catalog-modal.active, .history-modal.active {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding: 20px;
        }

        .catalog-modal-content, .history-modal-content {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            max-width: 1200px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 3px solid var(--primary-color);
            margin-top: 20px;
        }

        .catalog-section {
            margin-bottom: 30px;
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            overflow: hidden;
            background: var(--white);
        }

        .catalog-header {
            background: var(--gray-50);
            padding: 20px;
            border-bottom: 2px solid var(--primary-color);
        }

        .catalog-header h3 {
            font-size: 1.3rem;
            color: var(--secondary-color);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }

        .catalog-controls {
            display: flex;
            gap: 15px;
            align-items: end;
            flex-wrap: wrap;
        }

        .catalog-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr auto;
            gap: 15px;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--gray-200);
        }

        .catalog-grid:last-child {
            border-bottom: none;
        }

        .catalog-grid:nth-child(even) {
            background: var(--gray-50);
        }

        .product-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .product-name {
            font-weight: 600;
            color: var(--secondary-color);
        }

        .product-description {
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        .client-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 25px;
            background: var(--white);
            border-radius: 10px;
            border: 2px solid var(--primary-color);
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--secondary-color);
        }

        input, textarea, select {
            padding: 12px;
            border: 2px solid var(--gray-300);
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: border-color 0.3s ease;
            background: var(--white);
            color: var(--secondary-color);
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(244, 230, 0, 0.2);
        }

        .sections-container {
            margin-top: 30px;
        }

        .section {
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            margin-bottom: 25px;
            background: var(--white);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .section:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .section-header {
            background: var(--gray-50);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--primary-color);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--secondary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: 2px solid;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 14px;
            font-weight: 700;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            min-height: 40px;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .btn-danger {
            background: var(--white);
            color: var(--danger-color);
            border-color: var(--danger-color);
        }

        .btn-danger:hover {
            background: var(--danger-color);
            color: var(--white);
        }

        .btn-primary {
            background: var(--primary-color);
            color: var(--secondary-color);
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            border-color: var(--primary-dark);
        }

        .btn-success {
            background: var(--success-color);
            color: var(--white);
            border-color: var(--success-color);
            font-size: 16px;
            padding: 15px 30px;
            min-height: 50px;
        }

        .btn-success:hover {
            background: #16a34a;
            border-color: #16a34a;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            min-height: 32px;
        }

        .section-content {
            padding: 25px;
        }

        .section-items {
            margin-bottom: 20px;
        }

        .item-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr auto;
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: var(--gray-50);
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-200);
        }

        .product-selector {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .manual-input {
            margin-top: 10px;
        }

        .item-controls {
            display: flex;
            gap: 5px;
            flex-direction: column;
        }

        .discount-section {
            background: var(--white);
            border: 2px solid var(--warning-color);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-top: 15px;
        }

        .discount-section label {
            color: var(--secondary-color);
            font-weight: 700;
        }

        .payment-options {
            background: var(--white);
            border: 2px solid var(--primary-color);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-top: 15px;
        }

        .payment-options h4 {
            color: var(--secondary-color);
            margin-bottom: 10px;
            font-weight: 700;
        }

        .payment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .payment-option {
            background: var(--white);
            padding: 15px;
            border-radius: var(--border-radius);
            border: 2px solid var(--gray-300);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            color: var(--secondary-color);
        }

        .payment-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            background: var(--gray-50);
        }

        .payment-option.active {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: var(--secondary-color);
        }

        .summary {
            background: var(--white);
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
            border: 3px solid var(--primary-color);
        }

        .summary h3 {
            color: var(--secondary-color);
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 700;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--gray-300);
            color: var(--secondary-color);
        }

        .summary-row.total {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--secondary-color);
            border-bottom: 3px solid var(--primary-color);
            margin-top: 15px;
            padding-top: 20px;
        }

        .summary-row.tva {
            color: var(--gray-600);
            font-weight: 600;
        }

        .summary-row.monthly {
            background: var(--primary-color);
            color: var(--secondary-color);
            font-weight: 700;
            margin: 10px -15px;
            padding: 15px;
            border-radius: var(--border-radius);
            border: none;
        }

        .actions {
            text-align: center;
            margin-top: 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--primary-color);
        }

        .add-item-btn {
            background: var(--success-color);
            color: var(--white);
            border: 2px solid var(--success-color);
            padding: 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 700;
            width: 100%;
            margin-top: 15px;
            transition: all 0.3s ease;
            font-size: 16px;
            min-height: 50px;
        }

        .add-item-btn:hover {
            background: #16a34a;
            border-color: #16a34a;
            transform: translateY(-1px);
        }

        .free-label {
            color: var(--success-color);
            font-weight: bold;
            font-style: italic;
        }

        .close-modal {
            background: var(--danger-color);
            color: var(--white);
            border: 2px solid var(--danger-color);
            border-radius: var(--border-radius);
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .close-modal:hover {
            background: #dc2626;
            border-color: #dc2626;
        }

        /* Sample product rows for demo */
        .sample-item {
            background: var(--white);
            border-left: 4px solid var(--primary-color);
        }

        /* Loading state */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .quote-number {
            background: var(--primary-color);
            color: var(--secondary-color);
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
            border: 2px solid var(--secondary-color);
        }

        .history-item {
            background: var(--gray-50);
            border: 2px solid var(--gray-300);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .history-item:hover {
            border-color: var(--primary-color);
            background: var(--white);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .history-number {
            font-weight: 700;
            color: var(--primary-color);
        }

        .history-date {
            color: var(--gray-600);
            font-size: 0.9rem;
        }

        .history-client {
            font-weight: 600;
            color: var(--secondary-color);
        }

        .history-amount {
            color: var(--success-color);
            font-weight: 700;
        }

        /* Responsive Design - Tablette */
        @media (max-width: 1024px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                flex-direction: column;
                gap: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .catalog-controls {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .catalog-controls input {
                min-width: 150px;
                flex: 1;
            }
            
            .item-row {
                grid-template-columns: 1fr 80px 100px 80px auto;
                gap: 10px;
            }

            .catalog-toggle {
                bottom: 15px;
                right: 15px;
                padding: 12px 20px;
            }

            .history-toggle {
                bottom: 75px;
                right: 15px;
                padding: 12px 20px;
            }
        }

        /* Responsive Design - Mobile */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                margin: 0;
                border-radius: 8px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .nav-tab {
                padding: 15px;
                font-size: 14px;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .item-row {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
            }
            
            .item-controls {
                flex-direction: row;
                justify-content: center;
            }
            
            .client-info {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 20px;
            }

            .catalog-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
            }
            
            .catalog-controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .catalog-controls input,
            .catalog-controls button {
                width: 100%;
            }
            
            .section-header {
                padding: 15px;
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .section-title {
                font-size: 1.1rem;
            }
            
            .section-content {
                padding: 20px;
            }
            
            .payment-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .payment-option {
                padding: 12px;
                text-align: center;
            }
            
            .summary {
                padding: 20px;
            }
            
            .summary h3 {
                font-size: 1.5rem;
            }
            
            .summary-row {
                padding: 10px 0;
                font-size: 14px;
            }
            
            .summary-row.total {
                font-size: 1.1rem;
            }
            
            .btn-success {
                padding: 12px 24px;
                font-size: 14px;
            }
            
            /* Amélioration des champs de saisie sur mobile */
            input, textarea, select {
                font-size: 16px; /* Évite le zoom automatique sur iOS */
                padding: 15px;
            }
            
            .btn {
                padding: 12px 16px;
                font-size: 13px;
                min-height: 44px; /* Taille tactile recommandée */
            }
            
            .add-item-btn {
                padding: 18px;
                font-size: 16px;
                min-height: 50px;
            }

            .catalog-toggle {
                bottom: 10px;
                right: 10px;
                padding: 10px 15px;
                font-size: 12px;
            }

            .history-toggle {
                bottom: 65px;
                right: 10px;
                padding: 10px 15px;
                font-size: 12px;
            }

            .actions {
                flex-direction: column;
                align-items: center;
            }

            .actions .btn {
                width: 100%;
                max-width: 300px;
            }
        }

        .drive-info {
            background: var(--gray-50);
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius);
            padding: 10px;
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--gray-600);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <!-- Logo Dialarme encodé en base64 -->
            <svg class="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 200">
                <!-- Forme du logo style diamant/bouclier -->
                <defs>
                    <linearGradient id="goldGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#f4e600;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#d4c600;stop-opacity:1" />
                    </linearGradient>
                </defs>
                
                <!-- Contour extérieur noir -->
                <polygon fill="#000000" points="50,40 350,40 380,100 350,160 50,160 20,100"/>
                
                <!-- Fond intérieur gris foncé -->
                <polygon fill="#333333" points="60,50 340,50 365,100 340,150 60,150 35,100"/>
                
                <!-- Bordure jaune -->
                <polygon fill="url(#goldGradient)" points="70,60 330,60 350,100 330,140 70,140 50,100"/>
                
                <!-- Fond intérieur noir -->
                <polygon fill="#000000" points="80,70 320,70 335,100 320,130 80,130 65,100"/>
                
                <!-- Forme du chien de profil en jaune -->
                <g fill="url(#goldGradient)">
                    <!-- Corps du chien -->
                    <path d="M 120,95 Q 140,85 170,90 L 240,95 Q 250,90 260,95 L 280,100 Q 285,105 280,110 L 260,115 Q 250,120 240,115 L 170,110 Q 140,115 120,105 Z"/>
                    <!-- Tête du chien -->
                    <path d="M 240,95 Q 260,85 280,90 Q 290,85 300,90 Q 305,95 300,100 Q 295,105 285,105 Q 275,110 265,105 Q 255,100 240,95 Z"/>
                    <!-- Oreilles -->
                    <path d="M 275,85 Q 285,80 295,85 Q 290,90 280,90 Z"/>
                    <path d="M 295,85 Q 300,75 310,80 Q 305,90 295,90 Z"/>
                    <!-- Pattes -->
                    <rect x="145" y="110" width="8" height="15" rx="4"/>
                    <rect x="165" y="110" width="8" height="15" rx="4"/>
                    <rect x="220" y="110" width="8" height="15" rx="4"/>
                    <rect x="240" y="110" width="8" height="15" rx="4"/>
                </g>
                
                <!-- Texte DIALARME -->
                <text x="200" y="35" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#f4e600" text-anchor="middle">DIALARME</text>
            </svg>
            
            <div class="header-text">
                <h1>Générateur de Devis</h1>
                <p>Système d'alarme & Surveillance</p>
            </div>
        </div>
        
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="showTab('alarm')">Système d'Alarme</div>
            <div class="nav-tab" onclick="showTab('camera')">Caméra de Surveillance</div>
        </div>

        <!-- Onglet Système d'Alarme -->
        <div id="alarm-tab" class="tab-content active">
            <!-- Numéro de devis -->
            <div class="quote-number" id="alarmQuoteNumber">
                Devis N° : A-2025-001
            </div>

            <!-- Informations client -->
            <div class="client-info">
                <div class="form-group">
                    <label for="clientName">Nom du client *</label>
                    <input type="text" id="clientName" placeholder="Nom complet" value="Jean Dupont">
                </div>
                <div class="form-group">
                    <label for="clientAddress">Adresse</label>
                    <input type="text" id="clientAddress" placeholder="Adresse complète" value="Rue de la Paix 123, 1000 Lausanne">
                </div>
                <div class="form-group">
                    <label for="clientPhone">Téléphone</label>
                    <input type="tel" id="clientPhone" placeholder="Numéro de téléphone" value="+41 21 123 45 67">
                </div>
                <div class="form-group">
                    <label for="clientEmail">Email</label>
                    <input type="email" id="clientEmail" placeholder="Adresse email" value="jean.dupont@email.ch">
                </div>
                <div class="form-group">
                    <label for="commercial">Commercial *</label>
                    <select id="commercial" required>
                        <option value="">Sélectionner un commercial</option>
                        <option value="Arnaud Bloch">Arnaud Bloch</option>
                        <option value="Benali Kodad">Benali Kodad</option>
                        <option value="Matys Goiot">Matys Goiot</option>
                        <option value="Wassim Tahiri">Wassim Tahiri</option>
                        <option value="Alikhan Guisseinov">Alikhan Guisseinov</option>
                        <option value="Mohamed Tartik">Mohamed Tartik</option>
                        <option value="Nassim Jaza">Nassim Jaza</option>
                        <option value="Heythem Ziaya">Heythem Ziaya</option>
                        <option value="Thomas Garcia" selected>Thomas Garcia</option>
                        <option value="Samir Ouhameni">Samir Ouhameni</option>
                    </select>
                </div>
            </div>

            <!-- Sections du devis alarme -->
            <div class="sections-container">
                <!-- Section Matériel -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            Matériel
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="section-items" id="alarmMaterialItems">
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <select onchange="updateAlarmCalculations()">
                                        <option>Centrale AX Pro</option>
                                    </select>
                                </div>
                                <input type="number" value="1" readonly>
                                <input type="number" value="350.00" readonly>
                                <input type="number" value="350.00" readonly>
                                <div class="item-controls">
                                    <button class="btn btn-danger btn-small" onclick="removeItem(this); updateAlarmCalculations();">Supprimer</button>
                                </div>
                            </div>
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <select onchange="updateAlarmCalculations()">
                                        <option>Détecteur volumétrique (radio) x3</option>
                                    </select>
                                </div>
                                <input type="number" value="3" readonly>
                                <input type="number" value="25.00" readonly>
                                <input type="number" value="75.00" readonly>
                                <div class="item-controls">
                                    <button class="btn btn-danger btn-small" onclick="removeItem(this); updateAlarmCalculations();">Supprimer</button>
                                </div>
                            </div>
                        </div>
                        
                        <button class="add-item-btn" onclick="addAlarmMaterialItem()">
                            Ajouter un article
                        </button>
                        
                        <div class="discount-section">
                            <label>Remise (%)</label>
                            <input type="number" min="0" max="100" step="0.1" value="0" onchange="updateAlarmCalculations()">
                        </div>
                        
                        <div class="payment-options">
                            <h4>Facilités de paiement</h4>
                            <div class="payment-grid">
                                <div class="payment-option active" onclick="selectPaymentOption(this, 'alarm'); updateAlarmCalculations();">
                                    <strong>Comptant</strong><br>
                                    <small>Aucun supplément</small>
                                </div>
                                <div class="payment-option" onclick="selectPaymentOption(this, 'alarm'); updateAlarmCalculations();">
                                    <strong>24 mois</strong><br>
                                    <small>+10% sur la mensualité</small>
                                </div>
                                <div class="payment-option" onclick="selectPaymentOption(this, 'alarm'); updateAlarmCalculations();">
                                    <strong>36 mois</strong><br>
                                    <small>+15% sur la mensualité</small>
                                </div>
                                <div class="payment-option" onclick="selectPaymentOption(this, 'alarm'); updateAlarmCalculations();">
                                    <strong>48 mois</strong><br>
                                    <small>+20% sur la mensualité</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Installation -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            Installation et matériel supplémentaire
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="section-items" id="alarmInstallationItems">
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <select onchange="updateAlarmCalculations()">
                                        <option>Installation, paramétrages, tests, mise en service & formation</option>
                                    </select>
                                </div>
                                <input type="number" value="1" readonly>
                                <input type="number" value="0.00" readonly>
                                <div style="color: #22c55e; font-weight: bold;">OFFERT</div>
                                <div class="item-controls">
                                    <button class="btn btn-danger btn-small" onclick="removeItem(this); updateAlarmCalculations();">Supprimer</button>
                                </div>
                            </div>
                        </div>
                        
                        <button class="add-item-btn" onclick="addAlarmInstallationItem()">
                            Ajouter un article
                        </button>
                        
                        <div class="discount-section">
                            <label>Remise (%)</label>
                            <input type="number" min="0" max="100" step="0.1" value="0" onchange="updateAlarmCalculations()">
                        </div>
                    </div>
                </div>

                <!-- Section Frais de dossier -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            Frais de dossier
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="section-items" id="alarmFeesItems">
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <select onchange="updateAlarmCalculations()">
                                        <option>Frais de dossier</option>
                                    </select>
                                </div>
                                <input type="number" value="1" readonly>
                                <input type="number" value="190.00" readonly>
                                <input type="number" value="190.00" readonly>
                                <div class="item-controls">
                                    <button class="btn btn-danger btn-small" onclick="removeItem(this); updateAlarmCalculations();">Supprimer</button>
                                </div>
                            </div>
                        </div>
                        
                        <button class="add-item-btn" onclick="addAlarmFeesItem()">
                            Ajouter un article
                        </button>
                        
                        <div class="discount-section">
                            <label>Remise (%)</label>
                            <input type="number" min="0" max="100" step="0.1" value="0" onchange="updateAlarmCalculations()">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Résumé -->
            <div class="summary">
                <h3>Résumé du Devis Alarme</h3>
                <div id="alarmSummary">
                    <div class="summary-row">
                        <span><strong>Matériel</strong></span>
                        <span id="alarmMaterialTotal">425.00 CHF</span>
                    </div>
                    <div class="summary-row">
                        <span><strong>Installation et matériel supplémentaire</strong></span>
                        <span id="alarmInstallationTotal">0.00 CHF</span>
                    </div>
                    <div class="summary-row">
                        <span><strong>Frais de dossier</strong></span>
                        <span id="alarmFeesTotal">190.00 CHF</span>
                    </div>
                    <div class="summary-row">
                        <span>Sous-total HT</span>
                        <span id="alarmSubtotal">615.00 CHF</span>
                    </div>
                    <div class="summary-row tva">
                        <span>TVA (8.1%)</span>
                        <span id="alarmTva">49.82 CHF</span>
                    </div>
                    <div class="summary-row total">
                        <span>TOTAL TTC</span>
                        <span id="alarmTotal">664.82 CHF</span>
                    </div>
                    <div class="summary-row monthly" id="alarmMonthlyRow" style="display: none;">
                        <span>Mensualité</span>
                        <span id="alarmMonthly">0.00 CHF/mois</span>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="actions">
                <button class="btn btn-success" onclick="generatePDF('alarm')">
                    Générer le PDF
                </button>
                <button class="btn btn-primary" onclick="newQuote('alarm')">
                    Nouveau Devis
                </button>
            </div>
            
            <div class="drive-info">
                Note: Les PDFs générés seront automatiquement sauvegardés sur Google Drive pour archivage.
            </div>
        </div>

        <!-- Onglet Caméra de Surveillance -->
        <div id="camera-tab" class="tab-content">
            <!-- Numéro de devis -->
            <div class="quote-number" id="cameraQuoteNumber">
                Devis N° : C-2025-001
            </div>

            <!-- Informations client -->
            <div class="client-info">
                <div class="form-group">
                    <label for="cameraClientName">Nom du client *</label>
                    <input type="text" id="cameraClientName" placeholder="Nom complet" value="Marie Martin">
                </div>
                <div class="form-group">
                    <label for="cameraClientAddress">Adresse</label>
                    <input type="text" id="cameraClientAddress" placeholder="Adresse complète" value="Avenue des Alpes 45, 1820 Montreux">
                </div>
                <div class="form-group">
                    <label for="cameraClientPhone">Téléphone</label>
                    <input type="tel" id="cameraClientPhone" placeholder="Numéro de téléphone" value="+41 21 987 65 43">
                </div>
                <div class="form-group">
                    <label for="cameraClientEmail">Email</label>
                    <input type="email" id="cameraClientEmail" placeholder="Adresse email" value="marie.martin@email.ch">
                </div>
                <div class="form-group">
                    <label for="cameraCommercial">Commercial *</label>
                    <select id="cameraCommercial" required>
                        <option value="">Sélectionner un commercial</option>
                        <option value="Arnaud Bloch">Arnaud Bloch</option>
                        <option value="Benali Kodad">Benali Kodad</option>
                        <option value="Matys Goiot">Matys Goiot</option>
                        <option value="Wassim Tahiri">Wassim Tahiri</option>
                        <option value="Alikhan Guisseinov">Alikhan Guisseinov</option>
                        <option value="Mohamed Tartik">Mohamed Tartik</option>
                        <option value="Nassim Jaza">Nassim Jaza</option>
                        <option value="Heythem Ziaya">Heythem Ziaya</option>
                        <option value="Thomas Garcia" selected>Thomas Garcia</option>
                        <option value="Samir Ouhameni">Samir Ouhameni</option>
                    </select>
                </div>
            </div>

            <!-- Sections du devis caméra -->
            <div class="sections-container">
                <!-- Section Matériel -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            Matériel
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="section-items" id="cameraMaterialItems">
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <select onchange="updateCameraCalculations()">
                                        <option>Kit NVR 4 canaux + 2 caméras IP</option>
                                    </select>
                                </div>
                                <input type="number" value="1" readonly>
                                <input type="number" value="450.00" readonly>
                                <input type="number" value="450.00" readonly>
                                <div class="item-controls">
                                    <button class="btn btn-danger btn-small" onclick="removeItem(this); updateCameraCalculations();">Supprimer</button>
                                </div>
                            </div>
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <select onchange="updateCameraCalculations()">
                                        <option>Caméra IP extérieure supplémentaire</option>
                                    </select>
                                </div>
                                <input type="number" value="2" readonly>
                                <input type="number" value="120.00" readonly>
                                <input type="number" value="240.00" readonly>
                                <div class="item-controls">
                                    <button class="btn btn-danger btn-small" onclick="removeItem(this); updateCameraCalculations();">Supprimer</button>
                                </div>
                            </div>
                        </div>
                        
                        <button class="add-item-btn" onclick="addCameraMaterialItem()">
                            Ajouter un article
                        </button>
                        
                        <div class="discount-section">
                            <label>Remise (%)</label>
                            <input type="number" min="0" max="100" step="0.1" value="0" onchange="updateCameraCalculations()">
                        </div>
                        
                        <div class="payment-options">
                            <h4>Facilités de paiement</h4>
                            <div class="payment-grid">
                                <div class="payment-option active" onclick="selectPaymentOption(this, 'camera'); updateCameraCalculations();">
                                    <strong>Comptant</strong><br>
                                    <small>Aucun supplément</small>
                                </div>
                                <div class="payment-option" onclick="selectPaymentOption(this, 'camera'); updateCameraCalculations();">
                                    <strong>24 mois</strong><br>
                                    <small>+10% sur la mensualité</small>
                                </div>
                                <div class="payment-option" onclick="selectPaymentOption(this, 'camera'); updateCameraCalculations();">
                                    <strong>36 mois</strong><br>
                                    <small>+15% sur la mensualité</small>
                                </div>
                                <div class="payment-option" onclick="selectPaymentOption(this, 'camera'); updateCameraCalculations();">
                                    <strong>48 mois</strong><br>
                                    <small>+20% sur la mensualité</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Installation -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            Installation
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="section-items" id="cameraInstallationItems">
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <select onchange="updateCameraCalculations()">
                                        <option>Installation système de surveillance complet</option>
                                    </select>
                                </div>
                                <input type="number" value="1" readonly>
                                <input type="number" value="300.00" readonly>
                                <input type="number" value="300.00" readonly>
                                <div class="item-controls">
                                    <button class="btn btn-danger btn-small" onclick="removeItem(this); updateCameraCalculations();">Supprimer</button>
                                </div>
                            </div>
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <select onchange="updateCameraCalculations()">
                                        <option>Configuration et formation utilisateur</option>
                                    </select>
                                </div>
                                <input type="number" value="1" readonly>
                                <input type="number" value="0.00" readonly>
                                <div style="color: #22c55e; font-weight: bold;">OFFERT</div>
                                <div class="item-controls">
                                    <button class="btn btn-danger btn-small" onclick="removeItem(this); updateCameraCalculations();">Supprimer</button>
                                </div>
                            </div>
                        </div>
                        
                        <button class="add-item-btn" onclick="addCameraInstallationItem()">
                            Ajouter un article
                        </button>
                        
                        <div class="discount-section">
                            <label>Remise (%)</label>
                            <input type="number" min="0" max="100" step="0.1" value="0" onchange="updateCameraCalculations()">
                        </div>
                        
                        <div class="payment-options">
                            <h4>Facilités de paiement</h4>
                            <div class="payment-grid">
                                <div class="payment-option active" onclick="selectPaymentOption(this, 'camera'); updateCameraCalculations();">
                                    <strong>Comptant</strong><br>
                                    <small>Aucun supplément</small>
                                </div>
                                <div class="payment-option" onclick="selectPaymentOption(this, 'camera'); updateCameraCalculations();">
                                    <strong>24 mois</strong><br>
                                    <small>+10% sur la mensualité</small>
                                </div>
                                <div class="payment-option" onclick="selectPaymentOption(this, 'camera'); updateCameraCalculations();">
                                    <strong>36 mois</strong><br>
                                    <small>+15% sur la mensualité</small>
                                </div>
                                <div class="payment-option" onclick="selectPaymentOption(this, 'camera'); updateCameraCalculations();">
                                    <strong>48 mois</strong><br>
                                    <small>+20% sur la mensualité</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Vision à distance (Option) -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            Vision à distance (Option)
                        </div>
                        <div class="section-controls">
                            <div class="checkbox-group">
                                <input type="checkbox" id="visionOption" onchange="toggleVisionOption()">
                                <label for="visionOption">Inclure cette option</label>
                            </div>
                        </div>
                    </div>
                    <div class="section-content" id="visionContent" style="display: none;">
                        <div class="section-items">
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <span style="font-weight: 600;">Service de vision à distance</span>
                                    <div style="font-size: 0.9rem; color: var(--gray-600);">Accès sécurisé aux caméras via application mobile et web</div>
                                </div>
                                <input type="number" value="1" readonly>
                                <input type="number" value="20.00" readonly>
                                <div style="font-weight: 600; color: var(--secondary-color);">20.00 CHF/mois</div>
                                <div class="item-controls">
                                    <!-- Pas de bouton supprimer pour cette option -->
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: var(--gray-50); padding: 15px; border-radius: var(--border-radius); margin-top: 15px; border: 1px solid var(--gray-300);">
                            <h5 style="color: var(--secondary-color); margin-bottom: 10px;">Fonctionnalités incluses :</h5>
                            <ul style="color: var(--gray-600); margin-left: 20px;">
                                <li>Visualisation en temps réel</li>
                                <li>Enregistrement cloud sécurisé</li>
                                <li>Notifications d'alerte</li>
                                <li>Application mobile iOS/Android</li>
                                <li>Interface web</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Section Maintenance et garantie -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">
                            Maintenance et garantie
                        </div>
                    </div>
                    <div class="section-content">
                        <div class="section-items">
                            <div class="item-row sample-item">
                                <div class="product-selector">
                                    <span style="font-weight: 600;">Pack maintenance complet</span>
                                    <div style="font-size: 0.9rem; color: var(--gray-600);">Assistance, déplacements, pièces et support inclus</div>
                                </div>
                                <input type="number" value="1" readonly>
                                <input type="number" value="0.00" readonly>
                                <div style="color: #22c55e; font-weight: bold;">OFFERT</div>
                                <div class="item-controls">
                                    <!-- Pas de bouton supprimer pour cette section -->
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: var(--gray-50); padding: 15px; border-radius: var(--border-radius); margin-top: 15px; border: 1px solid var(--gray-300);">
                            <h5 style="color: var(--secondary-color); margin-bottom: 10px;">Services inclus gratuitement :</h5>
                            <ul style="color: var(--gray-600); margin-left: 20px;">
                                <li>Assistance hotline</li>
                                <li>Déplacement(s) sur site</li>
                                <li>Matériels et pièces de rechange</li>
                                <li>Main d'œuvre</li>
                                <li>Support téléphonique</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Résumé -->
            <div class="summary">
                <h3>Résumé du Devis Caméra</h3>
                <div id="cameraSummary">
                    <div class="summary-row">
                        <span><strong>Matériel</strong></span>
                        <span id="cameraMaterialTotal">690.00 CHF</span>
                    </div>
                    <div class="summary-row">
                        <span><strong>Installation</strong></span>
                        <span id="cameraInstallationTotal">300.00 CHF</span>
                    </div>
                    <div class="summary-row" id="visionSummaryRow" style="display: none;">
                        <span><strong>Vision à distance (mensuel)</strong></span>
                        <span>20.00 CHF/mois</span>
                    </div>
                    <div class="summary-row">
                        <span><strong>Maintenance et garantie</strong></span>
                        <span>0.00 CHF</span>
                    </div>
                    <div class="summary-row">
                        <span>Sous-total HT</span>
                        <span id="cameraSubtotal">990.00 CHF</span>
                    </div>
                    <div class="summary-row tva">
                        <span>TVA (8.1%)</span>
                        <span id="cameraTva">80.19 CHF</span>
                    </div>
                    <div class="summary-row total">
                        <span>TOTAL TTC</span>
                        <span id="cameraTotal">1070.19 CHF</span>
                    </div>
                    <div class="summary-row monthly" id="cameraMonthlyRow" style="display: none;">
                        <span>Mensualité avec vision à distance</span>
                        <span id="cameraMonthly">0.00 CHF/mois</span>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="actions">
                <button class="btn btn-success" onclick="generatePDF('camera')">
                    Générer le PDF
                </button>
                <button class="btn btn-primary" onclick="newQuote('camera')">
                    Nouveau Devis
                </button>
            </div>
            
            <div class="drive-info">
                Note: Les PDFs générés seront automatiquement sauvegardés sur Google Drive pour archivage.
            </div>
        </div>
    </div>

    <!-- Bouton flottant pour le catalogue -->
    <button class="catalog-toggle" onclick="toggleCatalog()">
        Catalogue
    </button>

    <!-- Bouton flottant pour l'historique -->
    <button class="history-toggle" onclick="toggleHistory()">
        Historique
    </button>

    <!-- Modal du catalogue -->
    <div class="catalog-modal" id="catalogModal">
        <div class="catalog-modal-content">
            <button class="close-modal" onclick="toggleCatalog()">Fermer le Catalogue</button>
            
            <h2 style="color: var(--secondary-color); margin-bottom: 20px; font-weight: 700;">Gestion du Catalogue Produits</h2>
            
            <!-- Catalogue Alarme -->
            <div class="catalog-section">
                <div class="catalog-header">
                    <h3>Matériel Alarme</h3>
                    <div class="catalog-controls">
                        <input type="text" id="newAlarmProductName" placeholder="Nom du produit">
                        <input type="text" id="newAlarmProductDesc" placeholder="Description">
                        <input type="number" id="newAlarmProductPrice" placeholder="Prix CHF HT" step="0.01">
                        <button class="btn btn-primary" onclick="addToCatalog('alarm')">Ajouter</button>
                    </div>
                </div>
                <div id="alarmCatalogItems">
                    <div class="catalog-grid">
                        <div class="product-item">
                            <div class="product-name">Centrale AX Pro</div>
                            <div class="product-description">Centrale d'alarme professionnelle</div>
                        </div>
                        <div>Qté: 1</div>
                        <div><strong>350.00 CHF</strong></div>
                        <button class="btn btn-danger btn-small" onclick="removeFromCatalog(this)">Supprimer</button>
                    </div>
                    <div class="catalog-grid">
                        <div class="product-item">
                            <div class="product-name">Détecteur volumétrique (radio)</div>
                            <div class="product-description">Détecteur de mouvement sans fil</div>
                        </div>
                        <div>Qté: 1</div>
                        <div><strong>25.00 CHF</strong></div>
                        <button class="btn btn-danger btn-small" onclick="removeFromCatalog(this)">Supprimer</button>
                    </div>
                </div>
            </div>

            <!-- Catalogue Caméra -->
            <div class="catalog-section">
                <div class="catalog-header">
                    <h3>Matériel Caméra</h3>
                    <div class="catalog-controls">
                        <input type="text" id="newCameraProductName" placeholder="Nom du produit">
                        <input type="text" id="newCameraProductDesc" placeholder="Description">
                        <input type="number" id="newCameraProductPrice" placeholder="Prix CHF HT" step="0.01">
                        <button class="btn btn-primary" onclick="addToCatalog('camera')">Ajouter</button>
                    </div>
                </div>
                <div id="cameraCatalogItems">
                    <div class="catalog-grid">
                        <div class="product-item">
                            <div class="product-name">Kit NVR 4 canaux + 2 caméras IP</div>
                            <div class="product-description">Kit complet de surveillance IP</div>
                        </div>
                        <div>Qté: 1</div>
