<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur de Devis Dialarme</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <link rel="stylesheet" href="frontend/style.css">
    <script defer src="frontend/script.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-img">D</div>
                <div class="company-info">
                    <h1>Dialarme</h1>
                    <p>G√©n√©rateur de devis professionnel</p>
                </div>
            </div>
            <div>
                <span id="currentDate"></span>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('alarm', this)">üö® Alarme</button>
            <button class="nav-tab" onclick="showTab('camera', this)">üìπ Cam√©ra de surveillance</button>
            <button class="nav-tab" onclick="showTab('fog', this)">üí® G√©n√©rateur de brouillard</button>
        </div>

<!-- TAB ALARME -->
        <div id="alarm-tab" class="tab-content active">
            <div class="rental-toggle-container">
                <span>Mode vente</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="alarm-rental-mode" onchange="toggleRentalMode('alarm')">
                    <span class="toggle-slider"></span>
                </label>
                <span>Location</span>
            </div>

            <div class="form-section">
                <h3>üìã Informations Client</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="clientName">Nom du client</label>
                        <input type="text" id="clientName" placeholder="Nom complet du client">
                    </div>
                    <div class="form-group">
                        <label for="commercial">Commercial</label>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <select id="commercial" onchange="handleCommercialSelection(this)" style="padding: 12px 15px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px;">
                                <option value="">S√©lectionner un commercial</option>
                            </select>
                            <input type="text" id="commercial-custom" placeholder="Entrez le nom du commercial" style="display: none; padding: 12px 15px; border: 2px solid #007bff; border-radius: 8px; font-size: 14px; background: #f0f8ff;">
                        </div>
                    </div>
                </div>
            </div>

            <div class="quote-section">
                <h3>üõ°Ô∏è 1. Kit de base 
                    <button class="add-product-btn" onclick="showKitSelector()" title="Ajouter un kit pr√©d√©fini">+</button>
                </h3>
                <div id="alarm-material-products"></div>
                <div class="discount-section">
                    <label>R√©duction:</label>
                    <select id="alarm-material-discount-type">
                        <option value="percent">%</option>
                        <option value="amount">CHF</option>
                    </select>
                    <input type="number" id="alarm-material-discount-value" placeholder="0" min="0" class="discount-input" oninput="updateTotals()">
                </div>
            </div>

            <div class="quote-section">
                <h3>üîß 2. Installation et mat√©riel suppl√©mentaire <button class="add-product-btn" onclick="addProductLine('alarm-installation')">+</button></h3>
                <div class="product-line" id="alarm-installation-line" style="background: #f0f8ff;">
                    <div>Installation, param√©trages, tests, mise en service & formation</div>
                    <div>
                        <label style="margin-right: 5px; font-size: 12px;">Nombre:</label>
                        <input type="number" id="alarm-installation-qty" value="1" min="1" max="10" class="quantity-input" oninput="updateAlarmInstallationPrice()">
                    </div>
                    <input type="number" id="alarm-installation-price" value="690" class="discount-input" placeholder="Prix" readonly style="background: #f0f0f0;">
                    <div class="checkbox-option" style="margin: 0;">
                        <input type="checkbox" id="alarm-installation-offered" class="offered-checkbox" onchange="updateTotals()">
                        <label style="margin: 0; font-size: 12px;">OFFERT</label>
                    </div>
                    <div class="price-display" id="alarm-installation-display">690.00 CHF</div>
                </div>
                <div class="product-line" id="alarm-uninstall-line" style="display: none;">
                    <div>D√©sinstallation factur√©e si dur√©e inf√©rieure √† 12 mois</div>
                    <input type="number" value="1" class="quantity-input" readonly>
                    <div></div>
                    <div class="price-display">290.00 CHF</div>
                    <div></div>
                </div>
                <div id="alarm-installation-products"></div>
                <div class="discount-section">
                    <label>R√©duction:</label>
                    <select id="alarm-installation-discount-type">
                        <option value="percent">%</option>
                        <option value="amount">CHF</option>
                    </select>
                    <input type="number" id="alarm-installation-discount-value" placeholder="0" min="0" class="discount-input" oninput="updateTotals()">
                </div>
            </div>

            <div class="quote-section">
                <h3>üìÑ 3. Frais de dossier</h3>
                <div class="product-line">
                    <div>Carte SIM + Activation</div>
                    <input type="number" value="1" class="quantity-input" readonly>
                    <div></div>
                    <div class="checkbox-option" style="margin: 0;">
                        <input type="checkbox" id="admin-simcard-offered" class="offered-checkbox" onchange="updateTotals()">
                        <label style="margin: 0; font-size: 12px;">OFFERT</label>
                    </div>
                    <div class="price-display" id="admin-simcard-display">50.00 CHF HT</div>
                </div>
                <div class="product-line">
                    <div>Frais de dossier</div>
                    <input type="number" value="1" class="quantity-input" readonly>
                    <div></div>
                    <div class="checkbox-option" style="margin: 0;">
                        <input type="checkbox" id="admin-processing-offered" class="offered-checkbox" onchange="updateTotals()">
                        <label style="margin: 0; font-size: 12px;">OFFERT</label>
                    </div>
                    <div class="price-display" id="admin-processing-display">190.00 CHF HT</div>
                </div>
                <p style="font-size: 12px; color: #6c757d; margin-top: 10px;">* Les frais de dossier se payent √† l'installation</p>
            </div>

            <div class="quote-section">
                <h3>üîß 4. Services</h3>
                <div class="product-line">
                    <div>Test Cyclique</div>
                    <div class="checkbox-option" style="margin: 0;">
                        <input type="checkbox" id="test-cyclique-selected" checked onchange="updateTotals()">
                        <label style="margin: 0; font-size: 12px;">Inclure</label>
                    </div>
                    <input type="number" id="test-cyclique-price" value="0" class="discount-input" placeholder="Prix" oninput="updateTotals()">
                    <div class="checkbox-option" style="margin: 0;">
                        <input type="checkbox" id="test-cyclique-offered" class="offered-checkbox" checked onchange="updateTotals()">
                        <label style="margin: 0; font-size: 12px;">OFFERT</label>
                    </div>
                    <div class="price-display" id="test-cyclique-total">OFFERT</div>
                </div>
                <div class="product-line">
                    <div>Service de surveillance</div>
                    <div>
                        <select id="surveillance-type" class="service-select" onchange="updateSurveillancePrice()">
                            <option value="">Aucun</option>
                            <option value="telesurveillance">T√©l√©surveillance Particulier</option>
                            <option value="telesurveillance-pro">T√©l√©surveillance Professionnel</option>
                            <option value="autosurveillance">Autosurveillance</option>
                            <option value="autosurveillance-pro">Autosurveillance Professionnel</option>
                        </select>
                    </div>
                    <input type="number" id="surveillance-price" value="0" class="discount-input" placeholder="Prix/mois" oninput="updateTotals()">
                    <div class="checkbox-option" style="margin: 0;">
                        <input type="checkbox" id="surveillance-offered" class="offered-checkbox" onchange="updateTotals()" disabled>
                        <label style="margin: 0; font-size: 12px;">OFFERT</label>
                    </div>
                    <div class="price-display" id="surveillance-total">0.00 CHF/mois</div>
                </div>
            </div>

            <div class="quote-section">
                <h3>‚≠ê 5. Options de l'offre</h3>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="checkbox" id="option-interventions-gratuites" onchange="updateTotals()">
                        <label for="option-interventions-gratuites">Interventions gratuites & illimit√©es des agents</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="option-interventions-annee" onchange="toggleInterventionsQty()">
                        <label for="option-interventions-annee">Intervention par ann√©e des agents</label>
                        <input type="number" id="interventions-qty" value="1" min="1" max="10" class="quantity-input" style="width: 60px; display: none;" oninput="updateTotals()">
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="option-service-cles" onchange="updateTotals()">
                        <label for="option-service-cles">Service des cl√©s offert</label>
                    </div>
                </div>
            </div>

            <div class="quote-section" id="alarm-payment-section">
                <h3>üí≥ 6. Mode de paiement</h3>
                <div class="payment-options" id="alarm-global-payment">
                    <div class="payment-option" data-months="0" onclick="selectGlobalPayment(this, 'alarm')">Comptant</div>
                    <div class="payment-option" data-months="24" onclick="selectGlobalPayment(this, 'alarm')">24 mois</div>
                    <div class="payment-option" data-months="36" onclick="selectGlobalPayment(this, 'alarm')">36 mois</div>
                    <div class="payment-option active" data-months="48" onclick="selectGlobalPayment(this, 'alarm')">48 mois</div>
                </div>
            </div>

            <div class="quote-summary">
                <h3>üìä R√©capitulatif du devis</h3>
                <div class="summary-item">
                    <span>Mat√©riel</span>
                    <span id="alarm-material-total">0.00 CHF</span>
                </div>
                <div class="summary-item">
                    <span>Installation</span>
                    <span id="alarm-installation-total">690.00 CHF</span>
                </div>
                <div class="summary-item">
                    <span>Frais de dossier</span>
                    <span id="alarm-admin-total">240.00 CHF HT</span>
                </div>
                <div class="summary-item">
                    <span>Service de surveillance</span>
                    <span id="surveillance-summary">0.00 CHF/mois</span>
                </div>
                <div class="summary-item">
                    <span>TOTAL HT (hors surveillance)</span>
                    <span id="alarm-total-ht">930.00 CHF</span>
                </div>
                <div class="summary-item">
                    <span>TOTAL TTC (hors surveillance)</span>
                    <span id="alarm-total-ttc">1004.40 CHF</span>
                </div>
                <div class="monthly-payment" id="alarm-monthly-payment" style="display: none;">
                    <strong>Mensualit√©s globales: <span id="alarm-monthly-amount">0 CHF</span>/mois pendant <span id="alarm-monthly-count">0</span> mois</strong>
                </div>
                <div class="monthly-payment" id="alarm-cash-payment" style="display: none;">
                    <strong>Montant comptant: <span id="alarm-cash-amount">0 CHF</span></strong>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="generatePDF('alarm')">üìÑ G√©n√©rer le PDF</button>
            </div>
        </div>

<!-- TAB CAMERA -->
        <div id="camera-tab" class="tab-content">
            <div class="rental-toggle-container">
                <span>Mode vente</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="camera-rental-mode" onchange="toggleRentalMode('camera')">
                    <span class="toggle-slider"></span>
                </label>
                <span>Location</span>
            </div>

            <div class="form-section">
                <h3>üìã Informations Client</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="clientNameCamera">Nom du client</label>
                        <input type="text" id="clientNameCamera" placeholder="Nom complet du client">
                    </div>
                    <div class="form-group">
                        <label for="commercialCamera">Commercial</label>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <select id="commercialCamera" onchange="handleCommercialSelectionCamera(this)" style="padding: 12px 15px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px;">
                                <option value="">S√©lectionner un commercial</option>
                            </select>
                            <input type="text" id="commercialCamera-custom" placeholder="Entrez le nom du commercial" style="display: none; padding: 12px 15px; border: 2px solid #007bff; border-radius: 8px; font-size: 14px; background: #f0f8ff;">
                        </div>
                    </div>
                </div>
            </div>

            <div class="quote-section">
                <h3>üìπ 1. Mat√©riel <button class="add-product-btn" onclick="addProductLine('camera-material')">+</button></h3>
                <div id="camera-material-products"></div>
                <div class="discount-section">
                    <label>R√©duction:</label>
                    <select id="camera-material-discount-type">
                        <option value="percent">%</option>
                        <option value="amount">CHF</option>
                    </select>
                    <input type="number" id="camera-material-discount-value" placeholder="0" min="0" class="discount-input" oninput="updateTotals()">
                </div>
            </div>

            <div class="quote-section">
                <h3>üîß 2. Installation</h3>
                <div class="product-line" id="camera-installation-line">
                    <div>Installation, param√©trages, tests, mise en service & formation des utilisateurs</div>
                    <div>
                        <label style="margin-right: 5px;">Nombre:</label>
                        <input type="number" id="camera-installation-qty" value="1" min="1" max="10" class="quantity-input" oninput="updateCameraInstallationPrice()">
                    </div>
                    <div class="checkbox-option" style="margin: 0;">
                        <input type="checkbox" id="camera-installation-offered" class="offered-checkbox" onchange="updateTotals()">
                        <label style="margin: 0; font-size: 12px;">OFFERT</label>
                    </div>
                    <div class="price-display" id="camera-installation-price">690.00 CHF</div>
                    <div></div>
                </div>
                <div class="product-line" id="camera-uninstall-line" style="display: none;">
                    <div>D√©sinstallation factur√©e si dur√©e inf√©rieure √† 12 mois</div>
                    <input type="number" value="1" class="quantity-input" readonly>
                    <div></div>
                    <div class="price-display">290.00 CHF</div>
                    <div></div>
                </div>
            </div>

            <div class="quote-section" id="camera-remote-section">
                <h3>üåê 3. Vision √† distance</h3>
                <div class="checkbox-option">
                    <input type="checkbox" id="camera-remote-access" onchange="updateTotals()">
                    <label for="camera-remote-access">Acc√®s √† distance s√©curis√© sur Modem ind√©pendant - 20 CHF/mois</label>
                </div>
            </div>

            <div class="quote-section" id="camera-maintenance-section">
                <h3>üîß 4. Maintenance et garantie</h3>
                <div class="product-line">
                    <div>Assistance hotline, d√©placement(s), mat√©riels pi√®ce(s), main d'≈ìuvre et support t√©l√©phonique</div>
                    <input type="number" value="1" class="quantity-input" readonly>
                    <div></div>
                    <div class="price-display"><span class="free-label">OFFERT</span></div>
                    <div></div>
                </div>
            </div>

            <div class="quote-section" id="camera-payment-section">
                <h3>üí≥ 5. Mode de paiement</h3>
                <div class="payment-options" id="camera-global-payment">
                    <div class="payment-option" data-months="0" onclick="selectGlobalPayment(this, 'camera')">Comptant</div>
                    <div class="payment-option" data-months="24" onclick="selectGlobalPayment(this, 'camera')">24 mois</div>
                    <div class="payment-option" data-months="36" onclick="selectGlobalPayment(this, 'camera')">36 mois</div>
                    <div class="payment-option active" data-months="48" onclick="selectGlobalPayment(this, 'camera')">48 mois</div>
                </div>
            </div>

            <div class="quote-summary">
                <h3>üìä R√©capitulatif du devis</h3>
                <div class="summary-item">
                    <span>Mat√©riel</span>
                    <span id="camera-material-total">0.00 CHF</span>
                </div>
                <div class="summary-item">
                    <span>Installation</span>
                    <span id="camera-installation-total">690.00 CHF</span>
                </div>
                <div class="summary-item" id="camera-remote-summary">
                    <span>Vision √† distance</span>
                    <span id="camera-remote-total">0.00 CHF/mois</span>
                </div>
                <div class="summary-item" id="camera-maintenance-summary">
                    <span>Maintenance</span>
                    <span>OFFERT</span>
                </div>
                <div class="summary-item">
                    <span>TOTAL HT</span>
                    <span id="camera-total-ht">690.00 CHF</span>
                </div>
                <div class="summary-item">
                    <span>TOTAL TTC</span>
                    <span id="camera-total-ttc">745.29 CHF</span>
                </div>
                <div class="monthly-payment" id="camera-monthly-payment" style="display: none;">
                    <strong>Mensualit√©s: <span id="camera-monthly-amount">0 CHF</span> x <span id="camera-monthly-count">0</span> mois</strong>
                    <div id="camera-remote-monthly" style="margin-top: 5px; display: none;">
                        + Vision √† distance: <strong>20 CHF/mois</strong>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="generatePDF('camera')">üìÑ G√©n√©rer le PDF</button>
            </div>
        </div>

        <!-- TAB FOG -->
        <div id="fog-tab" class="tab-content">
            <div class="form-section">
                <h3>üìã Informations Client</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="clientNameFog">Nom du client</label>
                        <input type="text" id="clientNameFog" placeholder="Nom complet du client">
                    </div>
                    <div class="form-group">
                        <label for="commercialFog">Commercial</label>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <select id="commercialFog" onchange="handleCommercialSelectionFog(this)" style="padding: 12px 15px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px;">
                                <option value="">S√©lectionner un commercial</option>
                            </select>
                            <input type="text" id="commercialFog-custom" placeholder="Entrez le nom du commercial" style="display: none; padding: 12px 15px; border: 2px solid #007bff; border-radius: 8px; font-size: 14px; background: #f0f8ff;">
                        </div>
                    </div>
                </div>
            </div>

            <div class="quote-section">
                <h3>üí® 1. Mat√©riel <button class="add-product-btn" onclick="addProductLine('fog-material')">+</button></h3>
                <div id="fog-material-products"></div>
                <div class="discount-section">
                    <label>R√©duction:</label>
                    <select id="fog-material-discount-type">
                        <option value="percent">%</option>
                        <option value="amount">CHF</option>
                    </select>
                    <input type="number" id="fog-material-discount-value" placeholder="0" min="0" class="discount-input" oninput="updateTotals()">
                </div>
            </div>

            <div class="quote-section">
                <h3>üîß 2. Installation</h3>
                <div class="product-line">
                    <div>Installation, param√©trages, tests, mise en service & formation</div>
                    <div>
                        <input type="number" value="1" class="quantity-input" readonly style="background: #f0f0f0;">
                    </div>
                    <div class="checkbox-option" style="margin: 0;">
                        <input type="checkbox" id="fog-installation-offered" class="offered-checkbox" onchange="updateTotals()">
                        <label style="margin: 0; font-size: 12px;">OFFERT</label>
                    </div>
                    <div class="price-display" id="fog-installation-price">490.00 CHF</div>
                    <div></div>
                </div>
                <p style="font-size: 12px; color: #6c757d; margin-top: 10px;">* Installation uniquement au comptant (pas de mensualit√©s)</p>
            </div>

            <div class="quote-section" id="fog-maintenance-section">
                <h3>üîß 3. Maintenance et garantie</h3>
                <div class="product-line">
                    <div>Assistance hotline, d√©placement(s), mat√©riels pi√®ce(s), main d'≈ìuvre et support t√©l√©phonique</div>
                    <input type="number" value="1" class="quantity-input" readonly>
                    <div></div>
                    <div class="price-display"><span class="free-label">OFFERT</span></div>
                    <div></div>
                </div>
            </div>

            <div class="quote-section" id="fog-payment-section">
                <h3>üí≥ 4. Mode de paiement</h3>
                <div class="payment-options" id="fog-global-payment">
                    <div class="payment-option" data-months="0" onclick="selectGlobalPayment(this, 'fog')">Comptant</div>
                    <div class="payment-option" data-months="24" onclick="selectGlobalPayment(this, 'fog')">24 mois</div>
                    <div class="payment-option" data-months="36" onclick="selectGlobalPayment(this, 'fog')">36 mois</div>
                    <div class="payment-option active" data-months="48" onclick="selectGlobalPayment(this, 'fog')">48 mois</div>
                </div>
            </div>

            <div class="quote-summary">
                <h3>üìä R√©capitulatif du devis</h3>
                <div class="summary-item">
                    <span>Mat√©riel</span>
                    <span id="fog-material-total">0.00 CHF</span>
                </div>
                <div class="summary-item">
                    <span>Installation</span>
                    <span id="fog-installation-total">490.00 CHF</span>
                </div>
                <div class="summary-item" id="fog-maintenance-summary">
                    <span>Maintenance</span>
                    <span>OFFERT</span>
                </div>
                <div class="summary-item">
                    <span>TOTAL HT</span>
                    <span id="fog-total-ht">490.00 CHF</span>
                </div>
                <div class="summary-item">
                    <span>TOTAL TTC</span>
                    <span id="fog-total-ttc">529.67 CHF</span>
                </div>
                <div class="monthly-payment" id="fog-monthly-payment" style="display: none;">
                    <strong>Mensualit√©s: <span id="fog-monthly-amount">0 CHF</span> x <span id="fog-monthly-count">0</span> mois</strong>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="generatePDF('fog')">üìÑ G√©n√©rer le PDF</button>
            </div>
        </div>
    </div>

</body>
</html>
